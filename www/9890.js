"use strict";(self.webpackChunkclimaja_app=self.webpackChunkclimaja_app||[]).push([[9890],{9890:(G,F,l)=>{l.r(F),l.d(F,{ForecastPageModule:()=>$});var p=l(177),x=l(4341),d=l(8974),P=l(3833),M=l(467),e=l(6276),b=l(4887),_=l(7690);let k=(()=>{class n{transform(t){return null==t?"":""+Math.round(10*t)/10}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275pipe=e.EJ8({name:"temperatura",type:n,pure:!0})}}return n})(),C=(()=>{class n{constructor(){this.diasSemana=["Domingo","Segunda-feira","Ter\xe7a-feira","Quarta-feira","Quinta-feira","Sexta-feira","S\xe1bado"],this.diasSemanaAbrev=["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"]}transform(t,a=!1){if(!t)return"";const i=new Date(t),r=new Date,o=new Date(r);if(o.setDate(r.getDate()+1),this.isSameDay(i,r))return"Hoje";if(this.isSameDay(i,o))return"Amanh\xe3";const g=i.getDay();return a?this.diasSemanaAbrev[g]:this.diasSemana[g]}isSameDay(t,a){return t.getDate()===a.getDate()&&t.getMonth()===a.getMonth()&&t.getFullYear()===a.getFullYear()}static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275pipe=e.EJ8({name:"diaSemana",type:n,pure:!0})}}return n})();function D(n,m){if(1&n&&(e.j41(0,"div",15)(1,"h1"),e.EFF(2),e.k0s(),e.j41(3,"p"),e.EFF(4,"Previs\xe3o estendida para os pr\xf3ximos dias"),e.k0s()()),2&n){const t=e.XpG();e.R7$(2),e.JRh(t.localizacaoAtual)}}function E(n,m){1&n&&e.nrm(0,"div",16)}function j(n,m){1&n&&(e.j41(0,"div",17),e.nrm(1,"ion-spinner",18),e.j41(2,"p"),e.EFF(3,"Carregando previs\xe3o..."),e.k0s()())}function I(n,m){if(1&n&&(e.j41(0,"ion-card",21)(1,"ion-card-content")(2,"div",22)(3,"div",23)(4,"h2"),e.EFF(5),e.nI1(6,"diaSemana"),e.k0s(),e.j41(7,"p"),e.EFF(8),e.nI1(9,"date"),e.k0s()(),e.j41(10,"div",24),e.nrm(11,"img",25),e.k0s(),e.j41(12,"div",26)(13,"div",27)(14,"span",28),e.EFF(15),e.nI1(16,"temperatura"),e.k0s()(),e.j41(17,"div",29)(18,"span",30),e.EFF(19),e.nI1(20,"temperatura"),e.k0s(),e.j41(21,"span",31),e.EFF(22,"/"),e.k0s(),e.j41(23,"span",32),e.EFF(24),e.nI1(25,"temperatura"),e.k0s()()(),e.j41(26,"div",33)(27,"p",34),e.EFF(28),e.nI1(29,"titlecase"),e.k0s()(),e.j41(30,"div",35)(31,"div",36),e.nrm(32,"ion-icon",37),e.j41(33,"span"),e.EFF(34),e.k0s()(),e.j41(35,"div",36),e.nrm(36,"ion-icon",38),e.j41(37,"span"),e.EFF(38),e.nI1(39,"number"),e.k0s()()()()()()),2&n){const t=m.$implicit,a=m.index,i=e.XpG(2);e.xc7("animation-delay",.1*a+"s"),e.AVh("animate-item",!0),e.R7$(5),e.JRh(e.bMT(6,14,t.data)),e.R7$(3),e.JRh(e.i5U(9,16,t.data,"dd/MM")),e.R7$(3),e.Y8G("src",i.getIconeClima(t.icone),e.B4B)("alt",t.descricao),e.R7$(4),e.SpI("",e.bMT(16,19,t.temperatura)," \xb0C"),e.R7$(4),e.SpI("",e.bMT(20,21,t.tempMin)," \xb0C"),e.R7$(5),e.SpI("",e.bMT(25,23,t.tempMax)," \xb0C"),e.R7$(4),e.JRh(e.bMT(29,25,t.descricao)),e.R7$(6),e.SpI("",t.umidade,"%"),e.R7$(4),e.SpI("",e.i5U(39,27,t.velocidadeVento,"1.1-1")," m/s")}}function S(n,m){if(1&n&&(e.j41(0,"div",19),e.DNE(1,I,40,30,"ion-card",20),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.previsoesPaginadas)("ngForTrackBy",t.trackByFn)}}function O(n,m){if(1&n){const t=e.RV6();e.j41(0,"div",39)(1,"div",40)(2,"ion-button",41),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.mudarPagina(i.paginaAtual-1))}),e.nrm(3,"ion-icon",42),e.EFF(4," Anterior "),e.k0s(),e.j41(5,"div",43)(6,"span"),e.EFF(7),e.k0s()(),e.j41(8,"ion-button",41),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.mudarPagina(i.paginaAtual+1))}),e.EFF(9," Pr\xf3ximo "),e.nrm(10,"ion-icon",44),e.k0s()()()}if(2&n){const t=e.XpG();e.R7$(2),e.Y8G("disabled",1===t.paginaAtual),e.R7$(5),e.Lme("",t.paginaAtual," de ",t.totalPaginas,""),e.R7$(1),e.Y8G("disabled",t.paginaAtual===t.totalPaginas)}}function R(n,m){if(1&n){const t=e.RV6();e.j41(0,"div",45)(1,"ion-card",46)(2,"ion-card-content")(3,"div",47),e.nrm(4,"ion-icon",48),e.j41(5,"h2"),e.EFF(6,"Nenhuma previs\xe3o encontrada"),e.k0s(),e.j41(7,"p"),e.EFF(8,"N\xe3o foi poss\xedvel carregar a previs\xe3o para esta cidade."),e.k0s(),e.j41(9,"ion-button",49),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.carregarPrevisao(i.localizacaoAtual))}),e.nrm(10,"ion-icon",50),e.EFF(11," Tentar novamente "),e.k0s()()()()()}}const T=[{path:"",component:(()=>{class n{constructor(t,a,i,r){this.route=t,this.climaService=a,this.localizacaoService=i,this.loadingCtrl=r,this.cidade="",this.previsao5Dias=[],this.paginaAtual=1,this.itensPorPagina=7,this.carregando=!1,this.localizacaoAtual=null}ngOnInit(){this.carregarLocalizacaoAtual()}carregarLocalizacaoAtual(){var t=this;return(0,M.A)(function*(){t.localizacaoService.obterLocalizacaoAtualSalva().subscribe(a=>{a?(t.localizacaoAtual=a,t.carregarPrevisao(a)):(t.localizacaoAtual=null,t.previsao5Dias=[])})})()}carregarPrevisao(t){var a=this;return(0,M.A)(function*(){const i=yield a.loadingCtrl.create({message:"Carregando previs\xe3o...",spinner:"crescent"});yield i.present();try{a.carregando=!0;const r=yield a.climaService.getPrevisao(t).toPromise(),o=new Map;r.list.forEach(s=>{const u=new Date(1e3*s.dt),h=u.toISOString().split("T")[0];if(o.has(h)){const c=o.get(h);c.temperaturas.push(s.main.temp),c.tempMin=Math.min(c.tempMin,s.main.temp_min),c.tempMax=Math.max(c.tempMax,s.main.temp_max),c.descricoes.push(s.weather[0].description),c.icones.push(s.weather[0].icon),c.umidades.push(s.main.humidity),c.velocidadesVento.push(s.wind.speed)}else o.set(h,{data:u,temperaturas:[s.main.temp],tempMin:s.main.temp_min,tempMax:s.main.temp_max,descricoes:[s.weather[0].description],icones:[s.weather[0].icon],umidades:[s.main.humidity],velocidadesVento:[s.wind.speed]})});const g=[],y=new Date;for(let s=0;s<7;s++){const u=new Date(y);u.setDate(y.getDate()+s);const h=u.toISOString().split("T")[0];if(o.has(h)){const c=o.get(h);g.push({data:u,temperatura:Math.round(c.temperaturas.reduce((f,v)=>f+v,0)/c.temperaturas.length),tempMin:Math.round(c.tempMin),tempMax:Math.round(c.tempMax),descricao:a.getMostFrequent(c.descricoes),icone:a.getMostFrequent(c.icones),umidade:Math.round(c.umidades.reduce((f,v)=>f+v,0)/c.umidades.length),velocidadeVento:Math.round(c.velocidadesVento.reduce((f,v)=>f+v,0)/c.velocidadesVento.length*10)/10})}else g.push(a.gerarPrevisaoEstimada(u,s))}a.previsao5Dias=g}catch(r){console.error("Erro ao carregar previs\xe3o:",r),a.gerarDadosExemplo()}finally{a.carregando=!1,yield i.dismiss()}})()}getMostFrequent(t){const a={};let i=0,r=t[0];return t.forEach(o=>{a[o]=(a[o]||0)+1,a[o]>i&&(i=a[o],r=o)}),r}gerarPrevisaoEstimada(t,a){const i=[{descricao:"c\xe9u limpo",icone:"01d",temp:25},{descricao:"poucas nuvens",icone:"02d",temp:23},{descricao:"nuvens dispersas",icone:"03d",temp:21},{descricao:"nublado",icone:"04d",temp:19},{descricao:"chuva leve",icone:"10d",temp:18}],r=i[a%i.length],o=6*Math.random()-3;return{data:t,temperatura:Math.round(r.temp+o),tempMin:Math.round(r.temp+o-5),tempMax:Math.round(r.temp+o+5),descricao:r.descricao,icone:r.icone,umidade:Math.round(50+40*Math.random()),velocidadeVento:Math.round(10*(2+8*Math.random()))/10}}gerarDadosExemplo(){const t=new Date;this.previsao5Dias=[];for(let a=0;a<7;a++){const i=new Date(t);i.setDate(t.getDate()+a),this.previsao5Dias.push(this.gerarPrevisaoEstimada(i,a))}}getIconeClima(t){return`https://openweathermap.org/img/wn/${t}@2x.png`}get previsoesPaginadas(){const t=(this.paginaAtual-1)*this.itensPorPagina;return this.previsao5Dias.slice(t,t+this.itensPorPagina)}get totalPaginas(){return Math.ceil(this.previsao5Dias.length/this.itensPorPagina)}mudarPagina(t){t>=1&&t<=this.totalPaginas&&(this.paginaAtual=t)}atualizar(t){var a=this;return(0,M.A)(function*(){a.localizacaoAtual&&(yield a.carregarPrevisao(a.localizacaoAtual)),t.target.complete()})()}trackByFn(t,a){return a.data}static{this.\u0275fac=function(a){return new(a||n)(e.rXU(P.nX),e.rXU(b.M),e.rXU(_.k),e.rXU(d.Xi))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-forecast"]],decls:19,vars:8,consts:[[1,"custom-header",3,"translucent"],["slot","start"],["defaultHref","/home"],[1,"header-title"],["name","calendar-outline",1,"header-icon"],[1,"forecast-content",3,"fullscreen"],[1,"forecast-background"],["class","city-header glass-effect",4,"ngIf","ngIfElse"],["noLocation",""],["class","loading-container",4,"ngIf"],["class","forecast-list",4,"ngIf"],["class","pagination-container glass-effect",4,"ngIf"],["class","empty-state",4,"ngIf"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Puxe para atualizar","refreshingSpinner","crescent","refreshingText","Atualizando..."],[1,"city-header","glass-effect"],[1,"no-location-message","glass-effect"],[1,"loading-container"],["name","crescent"],[1,"forecast-list"],["class","forecast-card glass-effect",3,"animate-item","animation-delay",4,"ngFor","ngForOf","ngForTrackBy"],[1,"forecast-card","glass-effect"],[1,"forecast-item"],[1,"date-section"],[1,"weather-icon-section"],[1,"weather-icon",3,"src","alt"],[1,"temperature-section"],[1,"temp-main"],[1,"temp-value"],[1,"temp-range"],[1,"temp-min"],[1,"temp-separator"],[1,"temp-max"],[1,"description-section"],[1,"weather-description"],[1,"details-section"],[1,"detail-item"],["name","water-outline"],["name","speedometer-outline"],[1,"pagination-container","glass-effect"],[1,"pagination-controls"],["fill","clear",3,"disabled","click"],["name","chevron-back-outline"],[1,"page-info"],["name","chevron-forward-outline"],[1,"empty-state"],[1,"empty-card","glass-effect"],[1,"empty-content"],["name","cloud-offline-outline",1,"empty-icon"],["fill","outline",3,"click"],["name","refresh-outline","slot","start"]],template:function(a,i){if(1&a&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button",2),e.k0s(),e.j41(4,"ion-title")(5,"div",3),e.nrm(6,"ion-icon",4),e.EFF(7," Previs\xe3o 7 Dias "),e.k0s()()()(),e.j41(8,"ion-content",5),e.nrm(9,"div",6),e.DNE(10,D,5,1,"div",7),e.DNE(11,E,1,0,"ng-template",null,8,e.C5r),e.DNE(13,j,4,0,"div",9),e.DNE(14,S,2,2,"div",10),e.DNE(15,O,11,4,"div",11),e.DNE(16,R,12,0,"div",12),e.j41(17,"ion-refresher",13),e.bIt("ionRefresh",function(o){return i.atualizar(o)}),e.nrm(18,"ion-refresher-content",14),e.k0s()()),2&a){const r=e.sdS(12);e.Y8G("translucent",!0),e.R7$(8),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("ngIf",i.localizacaoAtual)("ngIfElse",r),e.R7$(3),e.Y8G("ngIf",i.carregando),e.R7$(1),e.Y8G("ngIf",!i.carregando&&i.previsao5Dias.length>0),e.R7$(1),e.Y8G("ngIf",!i.carregando&&i.totalPaginas>1),e.R7$(1),e.Y8G("ngIf",!i.carregando&&0===i.previsao5Dias.length)}},dependencies:[p.Sq,p.bT,d.Jm,d.QW,d.b_,d.I9,d.W9,d.eU,d.iq,d.To,d.Ki,d.w2,d.BC,d.ai,d.el,p.QX,p.PV,p.vh,k,C],styles:["[_nghost-%COMP%]{--ion-background-color: var(--background-primary);color:var(--text-primary)}.forecast-content[_ngcontent-%COMP%]{background:var(--background-primary);color:var(--text-primary)}.city-header[_ngcontent-%COMP%]{background:var(--background-card);color:var(--text-primary);border-radius:var(--card-border-radius);padding:16px;margin:12px;text-align:center;font-weight:600}.forecast-card[_ngcontent-%COMP%]{background:var(--background-card);color:var(--text-primary);border-radius:var(--card-border-radius);margin:12px;padding:16px;box-shadow:var(--glass-shadow)}.forecast-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.date-section[_ngcontent-%COMP%], .weather-icon-section[_ngcontent-%COMP%], .temperature-section[_ngcontent-%COMP%], .description-section[_ngcontent-%COMP%], .details-section[_ngcontent-%COMP%]{color:var(--text-primary)}.temperature-section[_ngcontent-%COMP%]   .temp-main[_ngcontent-%COMP%]{font-weight:700;font-size:1.5em;color:var(--text-primary)}.temperature-section[_ngcontent-%COMP%]   .temp-range[_ngcontent-%COMP%]{color:var(--text-secondary)}.description-section[_ngcontent-%COMP%]{font-style:italic;color:var(--text-secondary)}.details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]{background:var(--background-secondary);border-radius:var(--card-border-radius-small);padding:4px 8px;margin:0 4px;color:var(--text-primary);display:inline-flex;align-items:center}.details-section[_ngcontent-%COMP%]   .detail-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-right:4px;color:var(--ion-color-primary)}.pagination-container[_ngcontent-%COMP%]{background:var(--background-card);border-radius:var(--card-border-radius);margin:12px;padding:8px;text-align:center;color:var(--text-primary)}.pagination-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{color:var(--ion-color-primary)}.empty-state[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]{color:var(--text-primary)}.empty-card[_ngcontent-%COMP%]{background:var(--background-card);color:var(--text-primary);border-radius:var(--card-border-radius);padding:16px;margin:12px;text-align:center}.empty-icon[_ngcontent-%COMP%]{font-size:3em;margin-bottom:8px}"]})}}return n})()}];let A=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[P.iI.forChild(T),P.iI]})}}return n})();var w=l(3887);let $=(()=>{class n{static{this.\u0275fac=function(a){return new(a||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[p.MD,x.YN,d.bv,A,w.G]})}}return n})()}}]);